<!doctype html>
if(!agree.checked){ agreeError.textContent='You must agree to the Privacy Policy.'; }
else { agreeError.textContent=''; }
if(okEmail && agree.checked){ submitBtn.disabled=false; submitBtn.classList.add('enabled'); }
else { submitBtn.disabled=true; submitBtn.classList.remove('enabled'); }
}


email.addEventListener('input', updateState);
agree.addEventListener('change', updateState);


// focus trap simple implementation
let focusableElements = []; let firstFocusable=null, lastFocusable=null;
function trapFocus(container){ focusableElements = container.querySelectorAll('a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])'); if(focusableElements.length){ firstFocusable = focusableElements[0]; lastFocusable = focusableElements[focusableElements.length-1]; container.addEventListener('keydown', handleTrap); }}
function handleTrap(e){ if(e.key!=='Tab') return; if(e.shiftKey){ if(document.activeElement===firstFocusable){ e.preventDefault(); lastFocusable.focus(); }} else { if(document.activeElement===lastFocusable){ e.preventDefault(); firstFocusable.focus(); }}}
function releaseFocusTrap(){ modalBackdrop.removeEventListener('keydown', handleTrap); }


// Submission
document.getElementById('interestForm').addEventListener('submit', function(e){ e.preventDefault(); updateState(); if(submitBtn.disabled) return; // show success
const modal = modalBackdrop.querySelector('.modal');
modal.innerHTML = `<div class="success" role="status"><h3 style="font-size:12px;color:var(--yellow)">Thank you! Your interest has been registered.</h3><div style="margin-top:12px;font-size:10px">âœ”</div></div>`;
setTimeout(close,3000);
});


// ---------- Audio Autoplay attempt with fallback ----------
const audio = document.getElementById('bgAudio');
const playOverlay = document.getElementById('playOverlay');
function tryPlay(){ audio.play().then(()=>{ playOverlay.style.display='none'; }).catch(()=>{ playOverlay.style.display='block'; }); }
// Try to play as soon as possible
window.addEventListener('load', ()=>{ tryPlay(); });
// If autoplay blocked, user can press overlay
playOverlay.addEventListener('click', ()=>{ audio.play().then(()=>{ playOverlay.style.display='none'; }).catch(()=>{}); });
playOverlay.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ audio.play().then(()=>{ playOverlay.style.display='none'; }).catch(()=>{}); } });


// Small accessibility: announce audio state
audio.addEventListener('play', ()=>{ audio.setAttribute('aria-hidden','false'); });


// If user navigates away/back, ensure audio plays on page show
document.addEventListener('visibilitychange', ()=>{ if(!document.hidden){ tryPlay(); }});
</script>
</body>
</html>
